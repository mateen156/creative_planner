(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{hmWn:function(e,t,c){"use strict";c.r(t),c.d(t,"ActionToProjectModule",(function(){return f}));var i=c("ofXK"),s=c("3Pt+"),n=c("tyNb"),o=c("ZE33"),a=c("Eu0l"),r=c("fXoL"),l=c("ps0H"),d=c("tHiJ"),h=c("0IaG"),b=c("FKr1"),p=c("6i5P"),u=c("Cj0y"),m=c("Egam"),g=c("ZOsW"),_=c("iadO");function D(e,t){if(1&e&&(r.cc(0,"ng-option",29),r.Xc(1),r.bc()),2&e){const e=t.$implicit;r.yc("value",e.Emp_No),r.Jb(1),r.Zc(" ",e.DisplayName," ")}}const S=[{path:"",component:(()=>{class e{constructor(e,t,c,i,s,n,r,l){this.notifyService=e,this.ProjectTypeService=t,this.router=c,this.dialog=i,this.dateAdapter=s,this.BsService=n,this.service=r,this._projectunplanned=l,this._inputAttachments=[],this.selectedEmpNo="",this._MainPrjectName="",this.dropdownSettings_EMP={},this.disablePreviousDate=new Date,this.task_id=null,this.ProjectsDropdownBoolean=!1,this._MasterCode=null,this.ProjectBlock=null,this.selectedFile=null,this.dropdownSettings_Projects={},this._EmployeeListForDropdown=[],this.selectedProjectCodelist=[],this.selected_Employee=[],this.CurrentUser_ID=localStorage.getItem("EmpNo"),this.ObjSubTaskDTO=new o.a,this.ObjUserDetails=new a.a,this.disablePreviousDate.setDate(this.disablePreviousDate.getDate()),this.BsService.bs_projectCode.subscribe(e=>{null==e?(this.ProjectsDropdownBoolean=!1,this.GetProjectsByUserName(),this._MasterCode=null):(this._MasterCode=e,this.ProjectsDropdownBoolean=!0)}),this.BsService.bs_ProjectName.subscribe(e=>this._MainPrjectName=e),this.BsService.bs_AssignId.subscribe(e=>this.task_id=e),this.BsService.bs_TaskName.subscribe(e=>{this.Sub_ProjectName=e}),this._inputAttachments=[]}ngOnInit(){this.GetAllEmployeesForAssignDropdown()}GetAllEmployeesForAssignDropdown(){this.service._GetCompletedProjects({pagenumber:1,Emp_No:this.CurrentUser_ID,Mode:"AssignedTask"}).subscribe(e=>{this._EmployeeListForDropdown=JSON.parse(e[0].EmployeeList),this.dropdownSettings_EMP={searchAutofocus:!0,singleSelection:!0,idField:"Emp_No",textField:"DisplayName",itemsShowLimit:2,closeDropDownOnSelection:!0,allowSearchFilter:!0}})}onFilterChange(e){this.filterText=e,this.GetProjectsByUserName()}ProjectOnSelect(e){this.selectedProjectCode=e.Project_Code}ProjectOnDeselect(e){this.selectedProjectCode=""}GetProjectsByUserName(){this.ObjUserDetails.PageNumber=1,this.ObjUserDetails.PageSize=30,this.ObjUserDetails.SearchText=this.filterText,this.service.GetProjectsForRunwayTaskDropdown(this.ObjUserDetails).subscribe(e=>{this._ProjectDataList=JSON.parse(e[0].DropdownProjects_Json),this.dropdownSettings_Projects={singleSelection:!0,idField:"Project_Code",textField:"Project_Name",itemsShowLimit:1,allowSearchFilter:!0,closeDropDownOnSelection:!0,clearSearchFilter:!0,searchPlaceholderText:"Search by project name",maxHeight:"500px",allowRemoteDataSearch:!0,noDataAvailablePlaceholderText:"Please wait.."}})}onFileChange(e){this._inputAttachments=[...this._inputAttachments,{FileName:e.target.files[0].name,Size:e.target.files[0].size,Files:e.target.files[0]}]}EmployeeOnSelect(e){this.selectedEmpNo=e}EmployeeOnDeselect(e){this.selectedEmpNo=null}OnSubmit(){""==this.Sub_ProjectName||null==this._StartDate||null==this._EndDate?this.notifyService.showInfo("","Star(*) mark feilds required "):(null==this._MasterCode?(this.ObjSubTaskDTO.MasterCode=this.selectedProjectCode,this._MasterCode=this.selectedProjectCode):this.ObjSubTaskDTO.MasterCode=this._MasterCode,this.service._GetNewProjectCode(this.ObjSubTaskDTO).subscribe(e=>{this.Sub_ProjectCode=e.SubTask_ProjectCode,this.EmpNo_Autho=e.Team_Autho,this.ProjectBlock=e.ProjectBlock,null!=this.task_id?this.ObjSubTaskDTO.AssignId=this.task_id:this.task_id=0,this.ObjSubTaskDTO.SubProject_Name=this.Sub_ProjectName,this.ObjSubTaskDTO.SubtaskDescription=this._Description,this.ObjSubTaskDTO.ProjectBlock=this.ProjectBlock,this.ObjSubTaskDTO.StartDate=this._StartDate,this.ObjSubTaskDTO.SubProject_DeadLine=this._EndDate;var t=this._StartDate.getTime()-this._EndDate.getTime();this.ObjSubTaskDTO.Duration=-t/864e5,this.ObjSubTaskDTO.Duration=8*this.ObjSubTaskDTO.Duration/1,this.ObjSubTaskDTO.Emp_No=this.CurrentUser_ID,this.ObjSubTaskDTO.AssignTo=this.selectedEmpNo,this.ObjSubTaskDTO.Remarks=this._remarks,this._inputAttachments.length>0&&(this.ObjSubTaskDTO.Attachments=this._inputAttachments[0].Files);var c=new Date(this._StartDate).toUTCString(),i=new Date(this._EndDate).toUTCString();const s=new FormData;s.append("Project_Code",this.Sub_ProjectCode),s.append("Team_Autho",this.EmpNo_Autho),this._inputAttachments.length>0?(s.append("Attachment","true"),s.append("file",this._inputAttachments[0].Files)):(s.append("Attachment","false"),s.append("file","")),s.append("_MasterCode",this.ObjSubTaskDTO.MasterCode),s.append("SubtaskName",this.Sub_ProjectName),s.append("Desc",this._Description),s.append("Projectblock",this.ProjectBlock),s.append("StartDate",c),s.append("EndDate",i),s.append("Duration",this.ObjSubTaskDTO.Duration.toString()),s.append("Emp_No",this.CurrentUser_ID),s.append("AssignTo",this.selectedEmpNo),s.append("Remarks",this._remarks),s.append("EmployeeName",localStorage.getItem("UserfullName")),s.append("AssignId",this.task_id.toString()),this.service._InsertNewSubtask(s).subscribe(e=>{this.notifyService.showInfo("Created Successfully","Action"),this._projectunplanned.CallOnSubmitCategory(),this.Clear_Feilds(),this.closeInfo(),this._inputAttachments=[]}),setTimeout(this._projectunplanned.CallOnSubmitCategory,3e3),setTimeout((function(){this.loadsubcateg()}),3e3),this._projectunplanned.CallOnSubmitCategory()}))}closeInfo(){document.getElementById("mysideInfobar").style.width="0",this.Clear_Feilds()}Clear_Feilds(){this.Sub_ProjectName="",this._Description="",this._StartDate=null,this._EndDate=null,this._remarks="",this._inputAttachments=[],this._inputAttachments2=[],this.selectedEmpNo="",this.selected_Employee=[]}}return e.\u0275fac=function(t){return new(t||e)(r.Wb(l.a),r.Wb(d.a),r.Wb(n.f),r.Wb(h.b),r.Wb(b.c),r.Wb(p.a),r.Wb(d.a),r.Wb(u.a))},e.\u0275cmp=r.Qb({type:e,selectors:[["app-action-to-project"]],decls:68,vars:19,consts:[["id","mysideInfobar_NewSubtask",1,"sideInfobar","animate-right","offcanvas"],[1,"p-4"],[1,"offcanvas-header","d-flex","align-items-center","justify-content-between","pb-2","mb-3","brdr-b"],["href","javascript:void(0)",1,"btn","btn-sm","btn-icon","btn-hover-primary","closebtn",3,"click"],[1,"fa","fa-times"],[1,"font-weight-bold","m-0"],[1,"pro-nm","text-info","mb-2"],[1,"form-group",3,"hidden"],[1,"text-danger"],[3,"placeholder","settings","data","ngModel","ngModelChange","onSelect","onDeSelect","onFilterChange"],[1,"form-group"],["type","text","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-control",2,"height","139px",3,"ngModel","ngModelChange"],[1,"form-group","text-dark-50","w-75px","flex-grow-1","brdng-0"],["placeholder","Select Employee",3,"change"],[3,"value",4,"ngFor","ngForOf"],[1,"input-group"],["matInput","","placeholder","Start Date",1,"form-control",3,"matDatepicker","min","ngModel","click","ngModelChange"],[1,"input-group-text","p-0"],["matSuffix","",3,"for"],["picker1",""],["matInput","","placeholder","End Date",1,"form-control",3,"matDatepicker","min","ngModel","click","ngModelChange"],["picker2",""],["for","exampleFormControlFile1"],["aria-label","With textarea",1,"form-control",2,"height","111px",3,"ngModel","ngModelChange"],[1,"custom-file","pl-1"],["type","file","id","uploadFile","accept","application/pdf",1,"form-control-file",3,"change"],[1,"form-group","mb-1"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],[3,"value"]],template:function(e,t){if(1&e){const e=r.dc();r.cc(0,"div",0),r.cc(1,"div",1),r.cc(2,"div",2),r.cc(3,"a",3),r.nc("click",(function(){return t.closeInfo()})),r.Xb(4,"i",4),r.bc(),r.cc(5,"h3",5),r.Xc(6,"Action To Project"),r.bc(),r.bc(),r.cc(7,"h5",6),r.Xc(8),r.bc(),r.cc(9,"div",7),r.cc(10,"label"),r.Xc(11,"Select Project :"),r.cc(12,"span",8),r.Xc(13,"*"),r.bc(),r.bc(),r.cc(14,"ng-multiselect-dropdown",9),r.nc("ngModelChange",(function(e){return t.selectedProjectCodelist=e}))("onSelect",(function(e){return t.ProjectOnSelect(e)}))("onDeSelect",(function(e){return t.ProjectOnDeselect(e)}))("onFilterChange",(function(e){return t.onFilterChange(e)})),r.bc(),r.bc(),r.cc(15,"div",10),r.cc(16,"label"),r.Xc(17," Action Name "),r.cc(18,"span",8),r.Xc(19,"*"),r.bc(),r.bc(),r.cc(20,"input",11),r.nc("ngModelChange",(function(e){return t.Sub_ProjectName=e})),r.bc(),r.bc(),r.cc(21,"div",10),r.cc(22,"label"),r.Xc(23,"Description :"),r.cc(24,"span",8),r.Xc(25,"*"),r.bc(),r.bc(),r.cc(26,"textarea",12),r.nc("ngModelChange",(function(e){return t._Description=e})),r.bc(),r.bc(),r.cc(27,"div",13),r.cc(28,"label"),r.Xc(29," Assign To "),r.cc(30,"span",8),r.Xc(31,"*"),r.bc(),r.Xc(32," : "),r.Xb(33,"strong"),r.bc(),r.cc(34,"ng-select",14),r.nc("change",(function(e){return t.EmployeeOnSelect(e)})),r.Vc(35,D,2,2,"ng-option",15),r.bc(),r.bc(),r.cc(36,"div",10),r.cc(37,"label"),r.Xc(38,"Start Date : "),r.cc(39,"span",8),r.Xc(40,"*"),r.bc(),r.bc(),r.cc(41,"div",16),r.cc(42,"input",17),r.nc("click",(function(){return r.Mc(e),r.Jc(46).open()}))("ngModelChange",(function(e){return t._StartDate=e})),r.bc(),r.cc(43,"div",18),r.Xb(44,"mat-datepicker-toggle",19),r.Xb(45,"mat-datepicker",null,20),r.bc(),r.bc(),r.bc(),r.cc(47,"div",10),r.cc(48,"label"),r.Xc(49,"End Date :"),r.cc(50,"span",8),r.Xc(51,"*"),r.bc(),r.bc(),r.cc(52,"div",16),r.cc(53,"input",21),r.nc("click",(function(){return r.Mc(e),r.Jc(57).open()}))("ngModelChange",(function(e){return t._EndDate=e})),r.bc(),r.cc(54,"div",18),r.Xb(55,"mat-datepicker-toggle",19),r.Xb(56,"mat-datepicker",null,22),r.bc(),r.bc(),r.bc(),r.cc(58,"div",10),r.cc(59,"label",23),r.Xc(60,"Remarks"),r.bc(),r.cc(61,"textarea",24),r.nc("ngModelChange",(function(e){return t._remarks=e})),r.bc(),r.bc(),r.cc(62,"div",10),r.cc(63,"div",25),r.cc(64,"input",26),r.nc("change",(function(e){return t.onFileChange(e)})),r.bc(),r.bc(),r.bc(),r.cc(65,"div",27),r.cc(66,"button",28),r.nc("click",(function(){return t.OnSubmit()})),r.Xc(67,"Submit "),r.bc(),r.bc(),r.bc(),r.bc()}if(2&e){const e=r.Jc(46),c=r.Jc(57);r.Jb(8),r.Yc(t._MainPrjectName),r.Jb(1),r.yc("hidden",t.ProjectsDropdownBoolean),r.Jb(5),r.yc("placeholder","Select Project")("settings",t.dropdownSettings_Projects)("data",t._ProjectDataList)("ngModel",t.selectedProjectCodelist),r.Jb(6),r.yc("ngModel",t.Sub_ProjectName),r.Jb(6),r.yc("ngModel",t._Description),r.Jb(9),r.yc("ngForOf",t._EmployeeListForDropdown),r.Jb(7),r.yc("matDatepicker",e)("min",t.disablePreviousDate)("ngModel",t._StartDate),r.Jb(2),r.yc("for",e),r.Jb(9),r.yc("matDatepicker",c)("min",t.disablePreviousDate)("ngModel",t._EndDate),r.Jb(2),r.yc("for",c),r.Jb(6),r.yc("ngModel",t._remarks),r.Jb(5),r.yc("disabled",!(t.selectedProjectCodelist&&t.Sub_ProjectName&&t._Description&&t.selected_Employee&&t._StartDate&&t._EndDate))}},directives:[m.a,s.n,s.q,s.d,s.u,g.a,i.n,_.b,_.d,_.a,g.c],styles:[""]}),e})()}];let j=(()=>{class e{}return e.\u0275mod=r.Ub({type:e}),e.\u0275inj=r.Tb({factory:function(t){return new(t||e)},imports:[[n.i.forChild(S)],n.i]}),e})(),f=(()=>{class e{}return e.\u0275mod=r.Ub({type:e}),e.\u0275inj=r.Tb({factory:function(t){return new(t||e)},providers:[l.a],imports:[[i.c,j,m.b,s.j,s.t,_.c,g.b]]}),e})()}}]);