{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{hmWn:function(e,t,c){\"use strict\";c.r(t),c.d(t,\"ActionToProjectModule\",(function(){return g}));var i=c(\"ofXK\"),s=c(\"3Pt+\"),n=c(\"tyNb\"),o=c(\"ZE33\"),r=c(\"Eu0l\"),a=c(\"fXoL\"),l=c(\"tHiJ\"),d=c(\"ps0H\"),h=c(\"6i5P\"),b=c(\"Egam\"),p=c(\"iadO\");const u=[{path:\"\",component:(()=>{class e{constructor(e,t,c,i){this.service=e,this.notifyService=t,this.router=c,this.BsService=i,this._inputAttachments=[],this.selectedEmpNo=null,this._MainPrjectName=null,this.dropdownSettings_EMP={},this.disablePreviousDate=new Date,this.task_id=null,this.ProjectsDropdownBoolean=!1,this._MasterCode=null,this.ProjectBlock=null,this.selectedFile=null,this.dropdownSettings_Projects={},this._EmployeeListForDropdown=[],this.selectedProjectCodelist=[],this.selected_Employee=[],this.CurrentUser_ID=localStorage.getItem(\"EmpNo\"),this.ObjSubTaskDTO=new o.a,this.ObjUserDetails=new r.a,this.disablePreviousDate.setDate(this.disablePreviousDate.getDate()),this.BsService.bs_projectCode.subscribe(e=>{null==e?(this.ProjectsDropdownBoolean=!1,this.GetProjectsByUserName(),this._MasterCode=null):(this._MasterCode=e,this.ProjectsDropdownBoolean=!0)}),this.BsService.bs_ProjectName.subscribe(e=>this._MainPrjectName=e),this.BsService.bs_AssignId.subscribe(e=>this.task_id=e),this.BsService.bs_TaskName.subscribe(e=>{this.Sub_ProjectName=e}),this._inputAttachments=[]}ngOnInit(){this.GetAllEmployeesForAssignDropdown()}GetAllEmployeesForAssignDropdown(){this.service._GetCompletedProjects({pagenumber:1,Emp_No:this.CurrentUser_ID,Mode:\"AssignedTask\"}).subscribe(e=>{this._EmployeeListForDropdown=JSON.parse(e[0].EmployeeList),this.dropdownSettings_EMP={searchAutofocus:!0,singleSelection:!0,idField:\"Emp_No\",textField:\"DisplayName\",itemsShowLimit:2,allowSearchFilter:!0,closeDropDownOnSelection:!0}})}onFilterChange(e){this.filterText=e,this.GetProjectsByUserName()}ProjectOnSelect(e){this.selectedProjectCode=e.Project_Code}ProjectOnDeselect(e){this.selectedProjectCode=\"\"}GetProjectsByUserName(){this.ObjUserDetails.PageNumber=1,this.ObjUserDetails.PageSize=30,this.ObjUserDetails.SearchText=this.filterText,this.service.GetProjectsForRunwayTaskDropdown(this.ObjUserDetails).subscribe(e=>{this._ProjectDataList=JSON.parse(e[0].DropdownProjects_Json),this.dropdownSettings_Projects={singleSelection:!0,idField:\"Project_Code\",textField:\"Project_Name\",itemsShowLimit:1,allowSearchFilter:!0,closeDropDownOnSelection:!0,clearSearchFilter:!0,searchPlaceholderText:\"Search by project name\",maxHeight:\"500px\",allowRemoteDataSearch:!0,noDataAvailablePlaceholderText:\"Please wait..\"}})}onFileChange(e){this._inputAttachments=[...this._inputAttachments,{FileName:e.target.files[0].name,Size:e.target.files[0].size,Files:e.target.files[0]}]}EmployeeOnSelect(e){this.selectedEmpNo=e.Emp_No}EmployeeOnDeselect(e){this.selectedEmpNo=null}OnSubmit(){\"\"==this.Sub_ProjectName||null==this._StartDate||null==this._EndDate?this.notifyService.showInfo(\"\",\"Star(*) mark feilds required \"):(null==this._MasterCode?(this.ObjSubTaskDTO.MasterCode=this.selectedProjectCode,this._MasterCode=this.selectedProjectCode):this.ObjSubTaskDTO.MasterCode=this._MasterCode,this.service._GetNewProjectCode(this.ObjSubTaskDTO).subscribe(e=>{this.Sub_ProjectCode=e.SubTask_ProjectCode,this.EmpNo_Autho=e.Team_Autho,this.ProjectBlock=e.ProjectBlock,null!=this.task_id?this.ObjSubTaskDTO.AssignId=this.task_id:this.task_id=0,this.ObjSubTaskDTO.SubProject_Name=this.Sub_ProjectName,this.ObjSubTaskDTO.SubtaskDescription=this._Description,this.ObjSubTaskDTO.ProjectBlock=this.ProjectBlock,this.ObjSubTaskDTO.StartDate=this._StartDate,this.ObjSubTaskDTO.SubProject_DeadLine=this._EndDate;var t=this._StartDate.getTime()-this._EndDate.getTime();this.ObjSubTaskDTO.Duration=-t/864e5,this.ObjSubTaskDTO.Duration=8*this.ObjSubTaskDTO.Duration/1,this.ObjSubTaskDTO.Emp_No=this.CurrentUser_ID,this.ObjSubTaskDTO.AssignTo=this.selectedEmpNo,this.ObjSubTaskDTO.Remarks=this._remarks,this._inputAttachments.length>0&&(this.ObjSubTaskDTO.Attachments=this._inputAttachments[0].Files);var c=new Date(this._StartDate).toUTCString(),i=new Date(this._EndDate).toUTCString();const s=new FormData;s.append(\"Project_Code\",this.Sub_ProjectCode),s.append(\"Team_Autho\",this.EmpNo_Autho),this._inputAttachments.length>0?(s.append(\"Attachment\",\"true\"),s.append(\"file\",this._inputAttachments[0].Files)):(s.append(\"Attachment\",\"false\"),s.append(\"file\",\"\")),s.append(\"_MasterCode\",this.ObjSubTaskDTO.MasterCode),s.append(\"SubtaskName\",this.Sub_ProjectName),s.append(\"Desc\",this._Description),s.append(\"Projectblock\",this.ProjectBlock),s.append(\"StartDate\",c),s.append(\"EndDate\",i),s.append(\"Duration\",this.ObjSubTaskDTO.Duration.toString()),s.append(\"Emp_No\",this.CurrentUser_ID),s.append(\"AssignTo\",this.selectedEmpNo),s.append(\"Remarks\",this._remarks),s.append(\"EmployeeName\",localStorage.getItem(\"UserfullName\")),s.append(\"AssignId\",this.task_id.toString()),this.service._InsertNewSubtask(s).subscribe(e=>{}),this.notifyService.showInfo(\"Created Successfully\",\"Action\"),this.closeInfo()}))}closeInfo(){document.getElementById(\"mysideInfobar\").style.width=\"0\",this.Clear_Feilds()}Clear_Feilds(){this.Sub_ProjectName=\"\",this._Description=\"\",this._StartDate=null,this._EndDate=null,this._remarks=\"\",this._inputAttachments=null,this._inputAttachments2=null,this.selectedEmpNo=\"\",this.selected_Employee=[]}}return e.\\u0275fac=function(t){return new(t||e)(a.Wb(l.a),a.Wb(d.a),a.Wb(n.f),a.Wb(h.a))},e.\\u0275cmp=a.Qb({type:e,selectors:[[\"app-action-to-project\"]],decls:67,vars:22,consts:[[\"id\",\"mysideInfobar_NewSubtask\",1,\"sideInfobar\",\"animate-right\",\"offcanvas\"],[1,\"p-4\"],[1,\"offcanvas-header\",\"d-flex\",\"align-items-center\",\"justify-content-between\",\"pb-2\",\"mb-3\",\"brdr-b\"],[\"href\",\"javascript:void(0)\",1,\"btn\",\"btn-sm\",\"btn-icon\",\"btn-hover-primary\",\"closebtn\",3,\"click\"],[1,\"fa\",\"fa-times\"],[1,\"font-weight-bold\",\"m-0\"],[1,\"pro-nm\",\"text-info\",\"mb-2\"],[1,\"form-group\",3,\"hidden\"],[1,\"text-danger\"],[3,\"placeholder\",\"settings\",\"data\",\"ngModel\",\"ngModelChange\",\"onSelect\",\"onDeSelect\",\"onFilterChange\"],[1,\"form-group\"],[\"type\",\"text\",\"required\",\"\",1,\"form-control\",3,\"ngModel\",\"ngModelChange\"],[1,\"form-control\",2,\"height\",\"139px\",3,\"ngModel\",\"ngModelChange\"],[\"autofocus\",\"true\",3,\"placeholder\",\"settings\",\"data\",\"ngModel\",\"ngModelChange\",\"onSelect\",\"onDeSelect\"],[1,\"input-group\"],[\"matInput\",\"\",\"placeholder\",\"Start Date\",1,\"form-control\",3,\"matDatepicker\",\"min\",\"ngModel\",\"click\",\"ngModelChange\"],[1,\"input-group-text\",\"p-0\"],[\"matSuffix\",\"\",3,\"for\"],[\"picker1\",\"\"],[\"matInput\",\"\",\"placeholder\",\"End Date\",1,\"form-control\",3,\"matDatepicker\",\"min\",\"ngModel\",\"click\",\"ngModelChange\"],[\"picker2\",\"\"],[\"for\",\"exampleFormControlFile1\"],[\"aria-label\",\"With textarea\",1,\"form-control\",2,\"height\",\"111px\",3,\"ngModel\",\"ngModelChange\"],[1,\"custom-file\",\"pl-1\"],[\"type\",\"file\",\"id\",\"uploadFile\",\"accept\",\"application/pdf\",1,\"form-control-file\",3,\"change\"],[1,\"form-group\",\"mb-1\"],[\"type\",\"submit\",1,\"btn\",\"btn-primary\",3,\"disabled\",\"click\"]],template:function(e,t){if(1&e){const e=a.dc();a.cc(0,\"div\",0),a.cc(1,\"div\",1),a.cc(2,\"div\",2),a.cc(3,\"a\",3),a.nc(\"click\",(function(){return t.closeInfo()})),a.Xb(4,\"i\",4),a.bc(),a.cc(5,\"h3\",5),a.Xc(6,\"Action To Project 123\"),a.bc(),a.bc(),a.cc(7,\"h5\",6),a.Xc(8),a.bc(),a.cc(9,\"div\",7),a.cc(10,\"label\"),a.Xc(11,\"Select Project :\"),a.cc(12,\"span\",8),a.Xc(13,\"*\"),a.bc(),a.bc(),a.cc(14,\"ng-multiselect-dropdown\",9),a.nc(\"ngModelChange\",(function(e){return t.selectedProjectCodelist=e}))(\"onSelect\",(function(e){return t.ProjectOnSelect(e)}))(\"onDeSelect\",(function(e){return t.ProjectOnDeselect(e)}))(\"onFilterChange\",(function(e){return t.onFilterChange(e)})),a.bc(),a.bc(),a.cc(15,\"div\",10),a.cc(16,\"label\"),a.Xc(17,\" Action Name \"),a.cc(18,\"span\",8),a.Xc(19,\"*\"),a.bc(),a.bc(),a.cc(20,\"input\",11),a.nc(\"ngModelChange\",(function(e){return t.Sub_ProjectName=e})),a.bc(),a.bc(),a.cc(21,\"div\",10),a.cc(22,\"label\"),a.Xc(23,\"Description :\"),a.cc(24,\"span\",8),a.Xc(25,\"*\"),a.bc(),a.bc(),a.cc(26,\"textarea\",12),a.nc(\"ngModelChange\",(function(e){return t._Description=e})),a.bc(),a.bc(),a.cc(27,\"div\",10),a.cc(28,\"label\"),a.Xc(29,\" Assign To \"),a.cc(30,\"span\",8),a.Xc(31,\"*\"),a.bc(),a.Xc(32,\" : \"),a.Xb(33,\"strong\"),a.bc(),a.cc(34,\"ng-multiselect-dropdown\",13),a.nc(\"ngModelChange\",(function(e){return t.selected_Employee=e}))(\"onSelect\",(function(e){return t.EmployeeOnSelect(e)}))(\"onDeSelect\",(function(e){return t.EmployeeOnDeselect(e)})),a.bc(),a.bc(),a.cc(35,\"div\",10),a.cc(36,\"label\"),a.Xc(37,\"Start Date : \"),a.cc(38,\"span\",8),a.Xc(39,\"*\"),a.bc(),a.bc(),a.cc(40,\"div\",14),a.cc(41,\"input\",15),a.nc(\"click\",(function(){return a.Mc(e),a.Jc(45).open()}))(\"ngModelChange\",(function(e){return t._StartDate=e})),a.bc(),a.cc(42,\"div\",16),a.Xb(43,\"mat-datepicker-toggle\",17),a.Xb(44,\"mat-datepicker\",null,18),a.bc(),a.bc(),a.bc(),a.cc(46,\"div\",10),a.cc(47,\"label\"),a.Xc(48,\"End Date :\"),a.cc(49,\"span\",8),a.Xc(50,\"*\"),a.bc(),a.bc(),a.cc(51,\"div\",14),a.cc(52,\"input\",19),a.nc(\"click\",(function(){return a.Mc(e),a.Jc(56).open()}))(\"ngModelChange\",(function(e){return t._EndDate=e})),a.bc(),a.cc(53,\"div\",16),a.Xb(54,\"mat-datepicker-toggle\",17),a.Xb(55,\"mat-datepicker\",null,20),a.bc(),a.bc(),a.bc(),a.cc(57,\"div\",10),a.cc(58,\"label\",21),a.Xc(59,\"Remarks\"),a.bc(),a.cc(60,\"textarea\",22),a.nc(\"ngModelChange\",(function(e){return t._remarks=e})),a.bc(),a.bc(),a.cc(61,\"div\",10),a.cc(62,\"div\",23),a.cc(63,\"input\",24),a.nc(\"change\",(function(e){return t.onFileChange(e)})),a.bc(),a.bc(),a.bc(),a.cc(64,\"div\",25),a.cc(65,\"button\",26),a.nc(\"click\",(function(){return t.OnSubmit()})),a.Xc(66,\"Submit \"),a.bc(),a.bc(),a.bc(),a.bc()}if(2&e){const e=a.Jc(45),c=a.Jc(56);a.Jb(8),a.Yc(t._MainPrjectName),a.Jb(1),a.yc(\"hidden\",t.ProjectsDropdownBoolean),a.Jb(5),a.yc(\"placeholder\",\"Select Project\")(\"settings\",t.dropdownSettings_Projects)(\"data\",t._ProjectDataList)(\"ngModel\",t.selectedProjectCodelist),a.Jb(6),a.yc(\"ngModel\",t.Sub_ProjectName),a.Jb(6),a.yc(\"ngModel\",t._Description),a.Jb(8),a.yc(\"placeholder\",\"Select Employee\")(\"settings\",t.dropdownSettings_EMP)(\"data\",t._EmployeeListForDropdown)(\"ngModel\",t.selected_Employee),a.Jb(7),a.yc(\"matDatepicker\",e)(\"min\",t.disablePreviousDate)(\"ngModel\",t._StartDate),a.Jb(2),a.yc(\"for\",e),a.Jb(9),a.yc(\"matDatepicker\",c)(\"min\",t.disablePreviousDate)(\"ngModel\",t._EndDate),a.Jb(2),a.yc(\"for\",c),a.Jb(6),a.yc(\"ngModel\",t._remarks),a.Jb(5),a.yc(\"disabled\",!(t.selectedProjectCodelist&&t.Sub_ProjectName&&t._Description&&t.selected_Employee&&t._StartDate&&t._EndDate))}},directives:[b.a,s.n,s.q,s.d,s.u,p.b,p.d,p.a],styles:[\"\"]}),e})()}];let m=(()=>{class e{}return e.\\u0275mod=a.Ub({type:e}),e.\\u0275inj=a.Tb({factory:function(t){return new(t||e)},imports:[[n.i.forChild(u)],n.i]}),e})(),g=(()=>{class e{}return e.\\u0275mod=a.Ub({type:e}),e.\\u0275inj=a.Tb({factory:function(t){return new(t||e)},imports:[[i.c,m,b.b,s.j,s.t,p.c]]}),e})()}}]);","extractedComments":[]}